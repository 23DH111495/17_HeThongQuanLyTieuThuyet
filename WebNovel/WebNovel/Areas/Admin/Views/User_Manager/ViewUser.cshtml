@model WebNovel.Models.ViewModels.UserViewModel
@{
    Layout = "~/Areas/Admin/Views/Shared/_NovelAdminLayout.cshtml";
}

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>User Details</title>
    <link href="~/Areas/Admin/CSS_SCRIPT/SideBar/Header.css" rel="stylesheet" />
    <link href="~/Areas/Admin/CSS_SCRIPT/User/User_View.css" rel="stylesheet" />
    <link href="~/Areas/Admin/CSS_SCRIPT/SideBar/BreadCrumb.css" rel="stylesheet" />
</head>
<body>
    <div class="top-bar">
        <div class="">
            <h1 class="page-title">User Details</h1>
            <p style="margin-left: 220px;">View comprehensive user information</p>
        </div>
        <div class="user-info">
            <span>Welcome, Admin</span>
            <div class="user-avatar">A</div>
        </div>
    </div>

    <div class="breadcrumb">
        <a href="@Url.Action("User_Manager")">User Manager</a> >
        <a href="@Url.Action("ViewUser")">@Model.Username</a>
    </div>

    <div class="container">
        <div class="header-actions">
            <a href="@Url.Action("User_Manager")" class="btn-back">
                <i class="fas fa-arrow-left"></i>
                Back to User List
            </a>
        </div>

        <div class="user-card">
            <div class="user-header">
                <div class="user-profile">
                    <div class="profile-avatar">
                        <img id="img-@Model.Id"
                             src="@Url.Action("GetProfilePicture", "User_Manager", new { id = Model.Id })"
                             alt="@Model.Username"
                             style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;"
                             onerror="handleImageError(@Model.Id, '@Model.ProfilePicture', '@Model.Username.Substring(0, 1).ToUpper()')" />
                    </div>
                    <div class="profile-details">
                        <h2>@Model.Username</h2>
                        <div class="profile-email">@Model.Email</div>
                        <div class="status-badges">
                            <span class="badge @(Model.IsActive ? "badge-active" : "badge-inactive")">
                                @Model.StatusBadge
                            </span>
                            <span class="badge @(Model.EmailVerified ? "badge-verified" : "badge-unverified")">
                                @Model.EmailStatusBadge
                            </span>
                            <span class="badge badge-role">@Model.RoleName</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="user-body">
                <div class="info-grid">
                    <div class="info-section">
                        <h3 class="section-title">
                            <i class="fas fa-user"></i>
                            Personal Information
                        </h3>
                        <div class="info-item">
                            <span class="info-label">User ID</span>
                            <span class="info-value">@Model.Id</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Full Name</span>
                            <span class="info-value">@Model.FullName</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Username</span>
                            <span class="info-value">@Model.Username</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Email Address</span>
                            <span class="info-value">@Model.Email</span>
                        </div>
                    </div>

                    <div class="info-section">
                        <h3 class="section-title">
                            <i class="fas fa-cog"></i>
                            Account Status
                        </h3>
                        <div class="info-item">
                            <span class="info-label">Status</span>
                            <span class="info-value">
                                <span class="badge @(Model.IsActive ? "badge-active" : "badge-inactive")">
                                    @Model.StatusBadge
                                </span>
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Email Verification</span>
                            <span class="info-value">
                                <span class="badge @(Model.EmailVerified ? "badge-verified" : "badge-unverified")">
                                    @Model.EmailStatusBadge
                                </span>
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Role</span>
                            <span class="info-value">
                                <span class="badge badge-role">@Model.RoleName</span>
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Account Age</span>
                            <span class="info-value">@((DateTime.Now - Model.JoinDate).Days) days</span>
                        </div>
                    </div>

                    <div class="info-section">
                        <h3 class="section-title">
                            <i class="fas fa-calendar"></i>
                            Timeline
                        </h3>
                        <div class="info-item">
                            <span class="info-label">Join Date</span>
                            <span class="info-value">@Model.JoinDate.ToString("MMMM dd, yyyy 'at' hh:mm tt")</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Last Login</span>
                            <span class="info-value">
                                @if (Model.LastLoginDate.HasValue)
                                {
                                    @Model.LastLoginDate.Value.ToString("MMMM dd, yyyy 'at' hh:mm tt")
                                }
                                else
                                {
                                    <span style="color: var(--text-secondary);">Never logged in</span>
                                }
                            </span>
                        </div>
                    </div>

                    <div class="timeline-section">
                        <h3 class="section-title">
                            <i class="fas fa-chart-line"></i>
                            Recent Activity
                        </h3>
                        <div class="timeline">
                            <div class="timeline-item">
                                <div class="timeline-icon"><i class="fas fa-user-plus"></i></div>
                                <div class="timeline-content">
                                    <h4>Account Created</h4>
                                    <p>User account was created on @Model.JoinDate.ToString("MMMM dd, yyyy")</p>
                                </div>
                            </div>
                            @if (Model.LastLoginDate.HasValue)
                            {
                                <div class="timeline-item">
                                    <div class="timeline-icon"><i class="fas fa-sign-in-alt"></i></div>
                                    <div class="timeline-content">
                                        <h4>Last Login</h4>
                                        <p>User last logged in on @Model.LastLoginDate.Value.ToString("MMMM dd, yyyy 'at' hh:mm tt")</p>
                                    </div>
                                </div>
                            }
                            @if (Model.EmailVerified)
                            {
                                <div class="timeline-item">
                                    <div class="timeline-icon"><i class="fas fa-check-circle"></i></div>
                                    <div class="timeline-content">
                                        <h4>Email Verified</h4>
                                        <p>User has verified their email address</p>
                                    </div>
                                </div>
                            }
                            @if (Model.RoleName != "No Role")
                            {
                                <div class="timeline-item">
                                    <div class="timeline-icon"><i class="fas fa-tags"></i></div>
                                    <div class="timeline-content">
                                        <h4>Role Assigned</h4>
                                        <p>User was assigned the role: @Model.RoleName</p>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-bar">
                <a href="@Url.Action("EditUser", new { id = Model.Id })" class="btn btn-primary">
                    <i class="fas fa-edit"></i>
                    Edit User
                </a>
                <a href="@Url.Action("ToggleActive", new { id = Model.Id })" class="btn btn-warning">
                    <i class="fas @(Model.IsActive ? "fa-ban" : "fa-check")"></i>
                    @(Model.IsActive ? "Deactivate" : "Activate")
                </a>
                <a href="@Url.Action("DeleteUser", new { id = Model.Id })" class="btn btn-danger">
                    <i class="fas fa-trash"></i>
                    Delete User
                </a>
            </div>
        </div>
    </div>

    <script src="~/Areas/Admin/CSS_SCRIPT/User/User_Manager.js"></script>
</body>
</html>